# Echoman æ•°æ®æµè½¬æ¶æ„æ–‡æ¡£

> ç‰ˆæœ¬ï¼šv2.0  
> æ›´æ–°æ—¶é—´ï¼š2025-11-07  
> æè¿°ï¼šæœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ Echoman ç³»ç»Ÿçš„æ•°æ®åº“è¡¨ç»“æ„ã€æ•°æ®æµè½¬é€»è¾‘å’Œå¤„ç†æµç¨‹  
> é‡è¦å˜æ›´ï¼šå·²å‡çº§ä¸ºä¸‰å‘¨æœŸå½’å¹¶æ¨¡å¼ï¼ˆAM/PM/EVEï¼‰ï¼Œç»Ÿä¸€å‘½åè§„èŒƒï¼ˆperiodï¼‰

---

## ğŸ“š ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ•°æ®åº“è¡¨ç»“æ„](#æ•°æ®åº“è¡¨ç»“æ„)
3. [æ•°æ®æµè½¬æµç¨‹](#æ•°æ®æµè½¬æµç¨‹)
4. [è¡¨å…³ç³»å›¾](#è¡¨å…³ç³»å›¾)
5. [å…³é”®æµç¨‹è¯¦è§£](#å…³é”®æµç¨‹è¯¦è§£)

---

## ç³»ç»Ÿæ¦‚è¿°

Echoman æ˜¯ä¸€ä¸ªçƒ­ç‚¹è¯é¢˜è¿½è¸ªç³»ç»Ÿï¼Œé€šè¿‡ä»¥ä¸‹æµç¨‹å®ç°ä»æ•°æ®é‡‡é›†åˆ°è¯é¢˜åˆ†æçš„å®Œæ•´é“¾è·¯ï¼š

```
æ•°æ®é‡‡é›†ï¼ˆ8æ¬¡/å¤©ï¼‰ â†’ æ•°æ®å»é‡ â†’ å‘¨æœŸå½’å¹¶ï¼ˆ3æ¬¡/å¤©ï¼Œ2é˜¶æ®µï¼‰ â†’ è¯é¢˜åˆ†ç±» â†’ AIæ‘˜è¦ç”Ÿæˆ â†’ å‰ç«¯å±•ç¤º
```

### æ ¸å¿ƒåŠŸèƒ½

- **å¤šå¹³å°é‡‡é›†**ï¼šä»å¾®åšã€çŸ¥ä¹ã€ä»Šæ—¥å¤´æ¡ç­‰7ä¸ªå¹³å°é‡‡é›†çƒ­æœæ•°æ®ï¼ˆæ¯æ—¥8æ¬¡ï¼Œ8:00-22:00ï¼‰
- **ä¸‰å‘¨æœŸå½’å¹¶**ï¼šæ¯æ—¥3æ¬¡å½’å¹¶ï¼ˆä¸ŠåˆAMã€ä¸‹åˆPMã€å‚æ™šEVEï¼‰ï¼Œæ¯æ¬¡åŒ…å«2ä¸ªé˜¶æ®µ
  - **é˜¶æ®µä¸€ï¼šæ–°äº‹ä»¶å½’å¹¶** - å»å™ªè¿‡æ»¤ï¼ŒéªŒè¯çœŸå®çƒ­ç‚¹
  - **é˜¶æ®µäºŒï¼šå…¨å±€å½’å¹¶** - å…³è”æ¼”è¿›ï¼Œç”Ÿæˆ/æ›´æ–°ä¸»é¢˜
- **åˆ†ç±»ç»Ÿè®¡**ï¼šå°†è¯é¢˜åˆ†ç±»ä¸ºå¨±ä¹ã€æ—¶äº‹ã€ä½“è‚²ä¸‰å¤§ç±»
- **çƒ­åº¦è¿½è¸ª**ï¼šè®°å½•è¯é¢˜åœ¨æ¯ä¸ªå½’å¹¶å‘¨æœŸçš„çƒ­åº¦å˜åŒ–
- **AIæ‘˜è¦**ï¼šä½¿ç”¨LLMç”Ÿæˆè¯é¢˜æ‘˜è¦å’Œå…³é”®ç‚¹

---

## æ•°æ®åº“è¡¨ç»“æ„

### 1. ğŸ“ source_itemsï¼ˆé‡‡é›†åŸå­é¡¹è¡¨ï¼‰

**ç”¨é€”**ï¼šå­˜å‚¨ä»å„å¹³å°é‡‡é›†çš„åŸå§‹æ–°é—»/çƒ­æœæ•°æ®

**å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `id` | BigInteger | ä¸»é”®ID |
| `platform` | String(20) | å¹³å°åç§°ï¼ˆweibo/zhihu/toutiao/sina/netease/baidu/hupuï¼‰ |
| `title` | String(500) | æ ‡é¢˜ |
| `summary` | Text | æ‘˜è¦/æ­£æ–‡ |
| `url` | String(1000) | åŸæ–‡é“¾æ¥ |
| `published_at` | DateTime | å‘å¸ƒæ—¶é—´ |
| `fetched_at` | DateTime | æŠ“å–æ—¶é—´ |
| `interactions` | JSONB | äº’åŠ¨ä¿¡æ¯ï¼ˆè½¬/è¯„/èµ/é˜…/è—ï¼‰ |
| `heat_value` | Float | åŸå§‹çƒ­åº¦å€¼ |
| `heat_normalized` | Float | å½’å¹¶å‘¨æœŸå†…å½’ä¸€åŒ–çƒ­åº¦ï¼ˆ0-1ï¼‰ |
| `url_hash` | String(64) | URLå“ˆå¸Œï¼ˆMD5ï¼‰ï¼Œç”¨äºå»é‡ |
| `content_hash` | String(64) | å†…å®¹å“ˆå¸Œï¼ˆMD5ï¼‰ï¼Œç”¨äºå»é‡ |
| `dedup_key` | String(100) | å»é‡é”®ï¼ˆå”¯ä¸€çº¦æŸï¼‰ |
| `period_merge_group_id` | String(50) | å½’å¹¶ç»„ID |
| `period` | String(20) | å½’å¹¶æ—¶æ®µï¼ˆå¦‚2025-11-07_AM/PM/EVEï¼‰ |
| `occurrence_count` | Integer | å½’å¹¶å‘¨æœŸå†…å‡ºç°æ¬¡æ•° |
| `merge_status` | String(30) | å½’å¹¶çŠ¶æ€ï¼ˆpending_event_merge/pending_global_merge/merged/discardedï¼‰ |
| `embedding_id` | BigInteger | å‘é‡IDï¼ˆå¤–é”®â†’embeddingsè¡¨ï¼‰ |
| `run_id` | String(50) | é‡‡é›†è¿è¡ŒID |

**ç´¢å¼•**ï¼š
- `idx_platform_fetched_at`ï¼šå¹³å°+æŠ“å–æ—¶é—´
- `idx_period_status`ï¼šå½’å¹¶æ—¶æ®µ+å½’å¹¶çŠ¶æ€
- `idx_merge_group`ï¼šå½’å¹¶ç»„ID+å‡ºç°æ¬¡æ•°

**ç‰¹ç‚¹**ï¼š
- æ•°æ®æºå¤´ï¼Œæ‰€æœ‰å¤„ç†éƒ½åŸºäºè¿™å¼ è¡¨
- é€šè¿‡ `dedup_key` å®ç°å»é‡
- `merge_status` è·Ÿè¸ªæ•°æ®å¤„ç†çŠ¶æ€

---

### 2. ğŸ¯ topicsï¼ˆä¸»é¢˜/äº‹ä»¶è¡¨ï¼‰

**ç”¨é€”**ï¼šå­˜å‚¨å½’å¹¶åçš„è¯é¢˜æ ¸å¿ƒä¿¡æ¯

**å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `id` | BigInteger | ä¸»é”®ID |
| `title_key` | String(500) | æ ‡é¢˜å½’å¹¶é”® |
| `first_seen` | DateTime | é¦–æ¬¡å‘ç°æ—¶é—´ |
| `last_active` | DateTime | æœ€åæ´»è·ƒæ—¶é—´ |
| `status` | String(20) | çŠ¶æ€ï¼ˆactive/endedï¼‰ |
| `intensity_total` | Integer | å¼ºåº¦æ€»é‡ï¼ˆè¦†ç›–é‡ç´¯åŠ ï¼‰ |
| `interaction_total` | BigInteger | äº’åŠ¨æ€»é‡ |
| `current_heat_normalized` | Float | å½“å‰å½’ä¸€åŒ–çƒ­åº¦ï¼ˆæœ€æ–°åŠæ—¥ï¼‰ |
| `heat_percentage` | Float | å½“å‰çƒ­åº¦å æ¯”ï¼ˆ%ï¼‰ |
| `summary_id` | BigInteger | å½“å‰ä¸»é¢˜æ‘˜è¦å¿«ç…§ID |
| `category` | String(50) | åˆ†ç±»ï¼ˆentertainment/current_affairs/sports_esportsï¼‰ |
| `category_confidence` | Float | åˆ†ç±»ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰ |
| `category_method` | String(20) | åˆ†ç±»æ–¹æ³•ï¼ˆllm/heuristic/manualï¼‰ |
| `category_updated_at` | DateTime | åˆ†ç±»æ›´æ–°æ—¶é—´ |

**å…³ç³»**ï¼š
- `nodes`ï¼šå…³è” `topic_nodes` è¡¨ï¼ˆæ—¶é—´çº¿èŠ‚ç‚¹ï¼‰
- `period_heats`ï¼šå…³è” `topic_period_heat` è¡¨ï¼ˆå‘¨æœŸçƒ­åº¦è®°å½•ï¼‰

**ç´¢å¼•**ï¼š
- `idx_status_last_active`ï¼šçŠ¶æ€+æœ€åæ´»è·ƒæ—¶é—´
- `idx_category_status`ï¼šåˆ†ç±»+çŠ¶æ€
- `idx_heat_normalized`ï¼šå½“å‰çƒ­åº¦

**ç‰¹ç‚¹**ï¼š
- æ ¸å¿ƒè¡¨ï¼Œä»£è¡¨ä¸€ä¸ªå®Œæ•´çš„çƒ­ç‚¹äº‹ä»¶
- å›å£°æŒ‡æ ‡ï¼ˆå¼ºåº¦ã€æŒç»­æ—¶é—´ï¼‰åœ¨æ­¤è®¡ç®—
- åˆ†ç±»ä¿¡æ¯ç”¨äºé¦–é¡µç»Ÿè®¡å±•ç¤º

---

### 3. ğŸ”— topic_nodesï¼ˆä¸»é¢˜æ—¶é—´çº¿èŠ‚ç‚¹è¡¨ï¼‰

**ç”¨é€”**ï¼šè®°å½•è¯é¢˜ä¸åŸå§‹æ–°é—»çš„å…³è”å…³ç³»ï¼Œå½¢æˆæ—¶é—´çº¿

**å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `id` | BigInteger | ä¸»é”®ID |
| `topic_id` | BigInteger | ä¸»é¢˜IDï¼ˆå¤–é”®â†’topicsï¼‰ |
| `source_item_id` | BigInteger | æºæ•°æ®é¡¹IDï¼ˆå¤–é”®â†’source_itemsï¼‰ |
| `appended_at` | DateTime | è¿½åŠ æ—¶é—´ |
| `delta_interactions` | Integer | æ–°å¢äº’åŠ¨é‡ |

**çº¦æŸ**ï¼š
- å”¯ä¸€çº¦æŸï¼š`(topic_id, source_item_id)`ï¼Œé˜²æ­¢é‡å¤å…³è”

**ç´¢å¼•**ï¼š
- `idx_topic_appended`ï¼šè¯é¢˜ID+è¿½åŠ æ—¶é—´

**ç‰¹ç‚¹**ï¼š
- æ„å»ºè¯é¢˜çš„å®Œæ•´æ—¶é—´çº¿
- å±•ç¤ºäº‹ä»¶æ¼”è¿›è¿‡ç¨‹
- æ”¯æŒå¢é‡æ›´æ–°

---

### 4. ğŸŒ¡ï¸ topic_period_heatï¼ˆä¸»é¢˜å½’å¹¶å‘¨æœŸçƒ­åº¦è®°å½•è¡¨ï¼‰

**ç”¨é€”**ï¼šè®°å½•æ¯ä¸ªè¯é¢˜åœ¨æ¯ä¸ªå½’å¹¶å‘¨æœŸï¼ˆAM/PM/EVEï¼‰çš„çƒ­åº¦å˜åŒ–

**å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `id` | BigInteger | ä¸»é”®ID |
| `topic_id` | BigInteger | ä¸»é¢˜IDï¼ˆå¤–é”®â†’topicsï¼‰ |
| `date` | Date | æ—¥æœŸ |
| `period` | String(10) | æ—¶æ®µï¼ˆAM/PM/EVEï¼‰ |
| `heat_normalized` | Float | å½’å¹¶å‘¨æœŸå†…å½’ä¸€åŒ–çƒ­åº¦ï¼ˆ0-1ï¼‰ |
| `heat_percentage` | Float | å å½’å¹¶å‘¨æœŸæ€»çƒ­åº¦ç™¾åˆ†æ¯” |
| `source_count` | Integer | å½’å¹¶å‘¨æœŸå†…çš„source_itemæ•°é‡ |

**çº¦æŸ**ï¼š
- å”¯ä¸€çº¦æŸï¼š`(topic_id, date, period)`

**ç´¢å¼•**ï¼š
- `idx_topic_date_period`ï¼šè¯é¢˜ID+æ—¥æœŸ+æ—¶æ®µ

**ç‰¹ç‚¹**ï¼š
- ç»˜åˆ¶è¯é¢˜çƒ­åº¦è¶‹åŠ¿å›¾ï¼ˆæ¯æ—¥3ä¸ªæ•°æ®ç‚¹ï¼‰
- åˆ†æè¯é¢˜ç”Ÿå‘½å‘¨æœŸå’Œçƒ­åº¦æ³¢åŠ¨
- æ”¯æŒä¸‰å‘¨æœŸç²’åº¦çš„çƒ­åº¦ç»Ÿè®¡ï¼ˆAM/PM/EVEï¼‰

---

### 5. ğŸ“„ summariesï¼ˆæ‘˜è¦å¿«ç…§è¡¨ï¼‰

**ç”¨é€”**ï¼šå­˜å‚¨è¯é¢˜çš„AIç”Ÿæˆæ‘˜è¦å†å²ç‰ˆæœ¬

**å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `id` | BigInteger | ä¸»é”®ID |
| `topic_id` | BigInteger | ä¸»é¢˜IDï¼ˆå¤–é”®â†’topicsï¼‰ |
| `content` | Text | æ‘˜è¦å†…å®¹ |
| `method` | String(20) | ç”Ÿæˆæ–¹æ³•ï¼ˆfull/incrementalï¼‰ |
| `generated_at` | DateTime | ç”Ÿæˆæ—¶é—´ |
| `provider` | String(50) | LLMæä¾›å•† |
| `model` | String(100) | LLMæ¨¡å‹åç§° |

**ç´¢å¼•**ï¼š
- `idx_topic_generated`ï¼šè¯é¢˜ID+ç”Ÿæˆæ—¶é—´

**ç‰¹ç‚¹**ï¼š
- ä¿å­˜è¯é¢˜æ‘˜è¦çš„å†å²å¿«ç…§
- æ”¯æŒå®Œæ•´ç”Ÿæˆå’Œå¢é‡ç”Ÿæˆä¸¤ç§æ–¹å¼
- å¯è¿½æº¯æ‘˜è¦å˜åŒ–å†å²

---

### 6. ğŸ“Š runs_ingestï¼ˆé‡‡é›†è¿è¡Œè®°å½•è¡¨ï¼‰

**ç”¨é€”**ï¼šè¿½è¸ªæ¯æ¬¡æ•°æ®é‡‡é›†ä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µ

**å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `run_id` | String(50) | è¿è¡ŒIDï¼ˆä¸»é”®ï¼‰ |
| `status` | String(20) | çŠ¶æ€ï¼ˆrunning/success/failed/partialï¼‰ |
| `started_at` | DateTime | å¼€å§‹æ—¶é—´ |
| `ended_at` | DateTime | ç»“æŸæ—¶é—´ |
| `duration_ms` | Integer | æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ |
| `total_platforms` | Integer | æ€»å¹³å°æ•° |
| `success_platforms` | Integer | æˆåŠŸå¹³å°æ•° |
| `failed_platforms` | Integer | å¤±è´¥å¹³å°æ•° |
| `total_items` | Integer | æ€»æŠ“å–æ¡æ•° |
| `success_items` | Integer | æˆåŠŸè§£ææ¡æ•° |
| `failed_items` | Integer | å¤±è´¥è§£ææ¡æ•° |
| `platform_results` | JSONB | å„å¹³å°ç»“æœè¯¦æƒ… |
| `error_summary` | Text | é”™è¯¯æ±‡æ€» |
| `config` | JSONB | è¿è¡Œé…ç½® |

**ç´¢å¼•**ï¼š
- `idx_status_started`ï¼šçŠ¶æ€+å¼€å§‹æ—¶é—´

**ç‰¹ç‚¹**ï¼š
- ç›‘æ§é‡‡é›†ä»»åŠ¡å¥åº·åº¦
- è¿½è¸ªå„å¹³å°é‡‡é›†æˆåŠŸç‡
- ç”¨äºç³»ç»Ÿè¿ç»´å’Œé—®é¢˜æ’æŸ¥

---

### 7. âš™ï¸ runs_pipelineï¼ˆæµæ°´çº¿è¿è¡Œè®°å½•è¡¨ï¼‰

**ç”¨é€”**ï¼šè¿½è¸ªæ•°æ®å¤„ç†æµæ°´çº¿å„é˜¶æ®µçš„æ‰§è¡Œæƒ…å†µ

**å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `run_id` | String(50) | è¿è¡ŒIDï¼ˆä¸»é”®ï¼‰ |
| `stage` | String(50) | é˜¶æ®µï¼ˆevent_merge/global_merge/classify/summarizeç­‰ï¼‰ |
| `status` | String(20) | çŠ¶æ€ï¼ˆrunning/success/failed/partialï¼‰ |
| `started_at` | DateTime | å¼€å§‹æ—¶é—´ |
| `ended_at` | DateTime | ç»“æŸæ—¶é—´ |
| `duration_ms` | Integer | æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ |
| `input_count` | Integer | è¾“å…¥æ•°é‡ |
| `output_count` | Integer | è¾“å‡ºæ•°é‡ |
| `success_count` | Integer | æˆåŠŸæ•°é‡ |
| `failed_count` | Integer | å¤±è´¥æ•°é‡ |
| `results` | JSONB | ç»“æœè¯¦æƒ… |
| `error_summary` | Text | é”™è¯¯æ±‡æ€» |
| `metrics` | JSONB | æ€§èƒ½æŒ‡æ ‡ |

**ç´¢å¼•**ï¼š
- `idx_stage_status`ï¼šé˜¶æ®µ+çŠ¶æ€
- `idx_started_at`ï¼šå¼€å§‹æ—¶é—´

**ç‰¹ç‚¹**ï¼š
- è¿½è¸ªæ•°æ®ä»åŸå§‹é‡‡é›†åˆ°è¯é¢˜ç”Ÿæˆçš„å®Œæ•´å¤„ç†é“¾è·¯
- è®°å½•æ¯ä¸ªé˜¶æ®µçš„æ€§èƒ½æŒ‡æ ‡
- ç”¨äºæµç¨‹ä¼˜åŒ–å’Œé—®é¢˜è¯Šæ–­

---

### 8. ğŸ“ˆ category_day_metricsï¼ˆåˆ†ç±»æ—¥æŒ‡æ ‡è¡¨ï¼‰

**ç”¨é€”**ï¼šå­˜å‚¨æ¯æ—¥å„åˆ†ç±»çš„ç»Ÿè®¡æŒ‡æ ‡ï¼ˆç”¨äºé¦–é¡µå±•ç¤ºï¼‰

**å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `day` | Date | æ—¥æœŸ |
| `category` | String(50) | åˆ†ç±» |
| `topics_count` | Integer | è¯é¢˜æ€»æ•° |
| `topics_active` | Integer | æ´»è·ƒè¯é¢˜æ•° |
| `topics_ended` | Integer | å·²ç»“æŸè¯é¢˜æ•° |
| `avg_length_hours` | Float | å¹³å‡å›å£°æ—¶é•¿ï¼ˆå°æ—¶ï¼‰ |
| `max_length_hours` | Float | æœ€é•¿å›å£°æ—¶é•¿ |
| `min_length_hours` | Float | æœ€çŸ­å›å£°æ—¶é•¿ |
| `max_length_topic_id` | BigInteger | æœ€é•¿æ—¶é•¿çš„è¯é¢˜ID |
| `min_length_topic_id` | BigInteger | æœ€çŸ­æ—¶é•¿çš„è¯é¢˜ID |
| `intensity_sum` | Integer | å¼ºåº¦æ€»å’Œ |
| `intensity_avg` | Float | å¹³å‡å¼ºåº¦ |

**ç‰¹ç‚¹**ï¼š
- é¢„è®¡ç®—é¦–é¡µçš„åˆ†ç±»ç»Ÿè®¡æ•°æ®
- æ¯æ—¥å‡Œæ™¨1:00è‡ªåŠ¨é‡ç®—
- æ”¯æŒç¼“å­˜åŠ é€ŸAPIå“åº”

---

## æ•°æ®æµè½¬æµç¨‹

### æ•´ä½“æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®é‡‡é›†é˜¶æ®µ                              â”‚
â”‚  å®šæ—¶ä»»åŠ¡ï¼šæ¯2å°æ—¶æ‰§è¡Œï¼ˆ8:00, 10:00, 12:00, 14:00, 16:00,      â”‚
â”‚           18:00, 20:00, 22:00ï¼‰                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å¤šå¹³å°çˆ¬è™«é‡‡é›†                                                â”‚
â”‚    - å¾®åšã€çŸ¥ä¹ã€ä»Šæ—¥å¤´æ¡ã€æ–°æµªã€ç½‘æ˜“ã€ç™¾åº¦ã€è™æ‰‘               â”‚
â”‚    - æ¯å¹³å°é‡‡é›†30æ¡çƒ­æœ                                          â”‚
â”‚    - è®°å½•åŸå§‹çƒ­åº¦å€¼ã€äº’åŠ¨æ•°æ®                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ•°æ®å…¥åº“ï¼ˆsource_itemsè¡¨ï¼‰                                   â”‚
â”‚    - è®¡ç®—URLå“ˆå¸Œå’Œå†…å®¹å“ˆå¸Œ                                       â”‚
â”‚    - ç”Ÿæˆdedup_keyè¿›è¡Œå»é‡                                      â”‚
â”‚    - è®¾ç½®merge_status = "pending_event_merge"                   â”‚
â”‚    - è®°å½•run_idå…³è”é‡‡é›†ä»»åŠ¡                                     â”‚
â”‚    - è‡ªåŠ¨æ ‡è®°periodï¼ˆAM/PM/EVEï¼‰                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. é‡‡é›†è¿è¡Œè®°å½•ï¼ˆruns_ingestè¡¨ï¼‰                                â”‚
â”‚    - è®°å½•é‡‡é›†å¼€å§‹/ç»“æŸæ—¶é—´                                       â”‚
â”‚    - ç»Ÿè®¡å„å¹³å°æˆåŠŸ/å¤±è´¥æ•°é‡                                     â”‚
â”‚    - ä¿å­˜å¹³å°è¯¦ç»†ç»“æœï¼ˆJSONï¼‰                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å½’å¹¶é˜¶æ®µï¼ˆæ¯æ—¥3æ¬¡ï¼‰                           â”‚
â”‚  å®šæ—¶ä»»åŠ¡ï¼š12:15/18:15/22:15ï¼ˆé˜¶æ®µä¸€ï¼‰                          â”‚
â”‚           12:30/18:30/22:30ï¼ˆé˜¶æ®µäºŒï¼‰                           â”‚
â”‚  å‘¨æœŸåˆ’åˆ†ï¼šAM(8-12ç‚¹), PM(14-18ç‚¹), EVE(20-22ç‚¹)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ã€å½’å¹¶é˜¶æ®µä¸€ã€‘æ–°äº‹ä»¶å½’å¹¶ï¼ˆevent_mergeï¼‰                      â”‚
â”‚    - çƒ­åº¦å½’ä¸€åŒ–ï¼ˆå½’å¹¶å‘¨æœŸå†…ï¼‰                                    â”‚
â”‚    - é€šè¿‡å‘é‡ç›¸ä¼¼åº¦èšç±»ç›¸ä¼¼æ–°é—»                                  â”‚
â”‚    - è¿‡æ»¤å•æ¬¡å‡ºç°çš„å™ªéŸ³ï¼ˆoccurrence_count < 2ï¼‰                 â”‚
â”‚    - ç”Ÿæˆperiod_merge_group_id                                  â”‚
â”‚    - æ›´æ–°merge_status = "pending_global_merge"                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ã€å½’å¹¶é˜¶æ®µäºŒã€‘å…¨å±€å½’å¹¶                         â”‚
â”‚  å®šæ—¶ä»»åŠ¡ï¼šæ¯æ—¥12:30ï¼ˆAMï¼‰, 18:30ï¼ˆPMï¼‰, 22:30ï¼ˆEVEï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. ä¸å†å²Topicæ¯”å¯¹ï¼ˆglobal_mergeï¼‰                              â”‚
â”‚    - æŸ¥è¯¢æ´»è·ƒçš„topicsï¼ˆstatus="active"ï¼‰                        â”‚
â”‚    - å°†æ–°å½’å¹¶ç»„ä¸å†å²topicè¿›è¡Œç›¸ä¼¼åº¦åŒ¹é…                         â”‚
â”‚    - åˆ¤æ–­æ˜¯è¿½åŠ åˆ°ç°æœ‰topicè¿˜æ˜¯åˆ›å»ºæ–°topic                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â†“                   â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ 5a. åˆ›å»ºæ–°Topic   â”‚  â”‚ 5b. è¿½åŠ åˆ°ç°æœ‰    â”‚
        â”‚  - æ’å…¥topicsè¡¨   â”‚  â”‚  - æ›´æ–°last_activeâ”‚
        â”‚  - ç”Ÿæˆtitle_key  â”‚  â”‚  - ç´¯åŠ å¼ºåº¦       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. åˆ›å»ºæ—¶é—´çº¿èŠ‚ç‚¹ï¼ˆtopic_nodesè¡¨ï¼‰                              â”‚
â”‚    - å…³è”topic_idå’Œsource_item_id                               â”‚
â”‚    - è®°å½•è¿½åŠ æ—¶é—´appended_at                                     â”‚
â”‚    - è®¡ç®—æ–°å¢äº’åŠ¨é‡delta_interactions                            â”‚
â”‚    - æ›´æ–°source_itemsçš„merge_status = "merged"                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. è®°å½•å‘¨æœŸçƒ­åº¦ï¼ˆtopic_period_heatè¡¨ï¼‰                          â”‚
â”‚    - è®¡ç®—topicåœ¨å½“å‰å½’å¹¶å‘¨æœŸçš„å½’ä¸€åŒ–çƒ­åº¦                         â”‚
â”‚    - è®¡ç®—çƒ­åº¦å æ¯”ï¼ˆç›¸å¯¹äºæ‰€æœ‰topicï¼‰                             â”‚
â”‚    - ç»Ÿè®¡source_countï¼ˆè¯¥å‘¨æœŸæ–°å¢çš„æ–°é—»æ•°ï¼‰                      â”‚
â”‚    - æ›´æ–°topicçš„current_heat_normalized                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åˆ†ç±»ä¸æ‘˜è¦é˜¶æ®µ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Topicåˆ†ç±»ï¼ˆå¯é€‰ï¼‰                                             â”‚
â”‚    - ä½¿ç”¨LLMå¯¹æ–°topicè¿›è¡Œåˆ†ç±»                                    â”‚
â”‚    - åˆ†ç±»ï¼šå¨±ä¹å…«å¦/ç¤¾ä¼šæ—¶äº‹/ä½“è‚²ç”µç«                            â”‚
â”‚    - è®°å½•åˆ†ç±»ç½®ä¿¡åº¦å’Œæ–¹æ³•                                        â”‚
â”‚    - æ›´æ–°topicsè¡¨çš„categoryå­—æ®µ                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. AIæ‘˜è¦ç”Ÿæˆï¼ˆsummariesè¡¨ï¼‰                                    â”‚
â”‚    - å…¨é‡ç”Ÿæˆï¼šåŸºäºæ‰€æœ‰timelineèŠ‚ç‚¹ç”Ÿæˆæ‘˜è¦                      â”‚
â”‚    - å¢é‡ç”Ÿæˆï¼šåŸºäºæ–°å¢èŠ‚ç‚¹æ›´æ–°æ‘˜è¦                              â”‚
â”‚    - æå–å…³é”®ç‚¹å’Œå®ä½“ä¿¡æ¯                                        â”‚
â”‚    - è®°å½•ä½¿ç”¨çš„LLMæ¨¡å‹å’Œç”Ÿæˆæ—¶é—´                                 â”‚
â”‚    - æ›´æ–°topicsçš„summary_id                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10. æµæ°´çº¿è¿è¡Œè®°å½•ï¼ˆruns_pipelineè¡¨ï¼‰                           â”‚
â”‚     - è®°å½•æ¯ä¸ªé˜¶æ®µçš„æ‰§è¡Œæƒ…å†µ                                     â”‚
â”‚     - ç»Ÿè®¡è¾“å…¥/è¾“å‡ºæ•°é‡                                          â”‚
â”‚     - ä¿å­˜æ€§èƒ½æŒ‡æ ‡å’Œé”™è¯¯ä¿¡æ¯                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯å±•ç¤ºé˜¶æ®µ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 11. é¦–é¡µå±•ç¤º                                                     â”‚
â”‚     - å±•ç¤ºåˆ†ç±»ç»Ÿè®¡ï¼ˆä»category_day_metricsè¯»å–ï¼‰                â”‚
â”‚     - æ¯æ—¥1:00è‡ªåŠ¨é‡ç®—åˆ†ç±»æŒ‡æ ‡                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 12. æ¢ç´¢é¡µå±•ç¤º                                                   â”‚
â”‚     - åˆ—è¡¨ï¼šæ˜¾ç¤ºæ´»è·ƒtopicsï¼ˆæŒ‰çƒ­åº¦æ’åºï¼‰                         â”‚
â”‚     - è¯¦æƒ…ï¼šæ˜¾ç¤ºtopicä¿¡æ¯ã€çƒ­åº¦è¶‹åŠ¿ã€æ—¶é—´çº¿                      â”‚
â”‚     - AIå¯¹è¯ï¼šåŸºäºtopicå†…å®¹è¿›è¡Œæ™ºèƒ½é—®ç­”                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## è¡¨å…³ç³»å›¾

### ERå…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   runs_ingest    â”‚ (é‡‡é›†è¿è¡Œè®°å½•)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ run_id
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  source_items    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚   embeddings     â”‚ (å‘é‡è¡¨)
â”‚  (é‡‡é›†åŸå­é¡¹)    â”‚embedding_id
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ period_merge_group_id
         â”‚ (å‘¨æœŸå½’å¹¶)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     topics       â”‚ (ä¸»é¢˜/äº‹ä»¶)
â”‚  - title_key     â”‚
â”‚  - status        â”‚
â”‚  - category      â”‚
â”‚  - intensity_*   â”‚
â”‚  - heat_*        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  â”‚
         â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   topic_nodes    â”‚  â”‚topic_period_heat â”‚ (å‘¨æœŸçƒ­åº¦è®°å½•)
â”‚  (æ—¶é—´çº¿èŠ‚ç‚¹)    â”‚  â”‚  - date          â”‚
â”‚  - topic_id      â”‚  â”‚  - period        â”‚
â”‚  - source_item_idâ”‚  â”‚  - heat_norm     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  - percentage    â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    summaries     â”‚ (æ‘˜è¦å¿«ç…§)
â”‚  - topic_id      â”‚
â”‚  - content       â”‚
â”‚  - method        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  runs_pipeline   â”‚ (æµæ°´çº¿è¿è¡Œè®°å½•)
â”‚  - stage         â”‚
â”‚  - status        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚category_day_metricsâ”‚ (åˆ†ç±»æ—¥æŒ‡æ ‡)
â”‚  - category      â”‚
â”‚  - avg_length    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµå‘

```
[çˆ¬è™«é‡‡é›†] 
    â†“
[source_items] â”€â”€â”€â”€â†’ [runs_ingest]
    â†“                     â†“
[å‘é‡åŒ–]              [ç›‘æ§é¢æ¿]
    â†“
[embeddings]
    â†“
[å‘¨æœŸå½’å¹¶-é˜¶æ®µä¸€] â”€â”€â”€â”€â†’ [runs_pipeline]
    â†“                     â†“
[å‘¨æœŸå½’å¹¶-é˜¶æ®µäºŒ]      [æµç¨‹ç›‘æ§]
    â†“
[topics] â†â”€â”€â”€ [topic_nodes] â†â”€â”€â”€ [source_items]
    â†“
    â”œâ”€â”€â†’ [topic_period_heat] (çƒ­åº¦è¶‹åŠ¿)
    â”œâ”€â”€â†’ [summaries] (AIæ‘˜è¦)
    â””â”€â”€â†’ [category_day_metrics] (åˆ†ç±»ç»Ÿè®¡)
            â†“
        [å‰ç«¯API]
            â†“
        [ç”¨æˆ·ç•Œé¢]
```

---

## å…³é”®æµç¨‹è¯¦è§£

### 1. æ•°æ®é‡‡é›†æµç¨‹

**è§¦å‘æ—¶æœº**ï¼šæ¯2å°æ—¶ï¼ˆ8:00, 10:00, 12:00, 14:00, 16:00, 18:00, 20:00, 22:00ï¼‰

**æ‰§è¡Œæ­¥éª¤**ï¼š

```python
# ä¼ªä»£ç 
def scheduled_ingestion():
    run_id = generate_run_id()
    
    # 1. åˆ›å»ºé‡‡é›†è¿è¡Œè®°å½•
    run = RunIngest(run_id=run_id, status="running")
    db.add(run)
    
    # 2. å¹¶å‘é‡‡é›†å„å¹³å°æ•°æ®
    platforms = ["weibo", "zhihu", "toutiao", "sina", "netease", "baidu", "hupu"]
    results = []
    
    for platform in platforms:
        items = scrape_platform(platform, limit=30)
        
        # 3. å¤„ç†æ¯æ¡æ•°æ®
        for item in items:
            # è®¡ç®—å“ˆå¸Œ
            url_hash = md5(item.url)
            content_hash = md5(item.title + item.summary)
            dedup_key = f"{platform}_{url_hash}"
            
            # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
            if exists(dedup_key):
                continue
            
            # 4. å…¥åº“
            source_item = SourceItem(
                platform=platform,
                title=item.title,
                url=item.url,
                url_hash=url_hash,
                content_hash=content_hash,
                dedup_key=dedup_key,
                merge_status="pending_event_merge",
                run_id=run_id
            )
            db.add(source_item)
        
        results.append({
            "platform": platform,
            "success": len(items),
            "total": 30
        })
    
    # 5. æ›´æ–°è¿è¡Œè®°å½•
    run.status = "success"
    run.ended_at = now()
    run.platform_results = results
    db.commit()
```

**è¾“å‡º**ï¼š
- `source_items` è¡¨æ–°å¢çº¦160æ¡è®°å½•ï¼ˆ7å¹³å° Ã— 30æ¡ï¼Œå»é‡åå¯èƒ½æ›´å°‘ï¼‰
- `runs_ingest` è¡¨æ–°å¢1æ¡è¿è¡Œè®°å½•

---

### 2. æ–°äº‹ä»¶å½’å¹¶æµç¨‹ï¼ˆé˜¶æ®µä¸€ï¼‰

**è§¦å‘æ—¶æœº**ï¼šæ¯æ—¥12:15ï¼ˆAMï¼‰, 18:15ï¼ˆPMï¼‰, 22:15ï¼ˆEVEï¼‰

**æ‰§è¡Œæ­¥éª¤**ï¼š

```python
# ä¼ªä»£ç 
def event_merge(period="AM"):  # period: AM/PM/EVE
    # 1. ç¡®å®šæ—¶é—´èŒƒå›´ï¼ˆåŸºäºperiodè‡ªåŠ¨åˆ¤æ–­ï¼‰
    date = today()
    period_tag = f"{date}_{period}"
    
    # 2. æŸ¥è¯¢å¾…å½’å¹¶çš„æ•°æ®ï¼ˆå½“å‰å‘¨æœŸï¼‰
    items = db.query(SourceItem).filter(
        SourceItem.period == period_tag,
        SourceItem.merge_status == "pending_event_merge"
    ).all()
    
    # 3. çƒ­åº¦å½’ä¸€åŒ–ï¼ˆå‘¨æœŸå†…ï¼‰
    normalize_heat(items, period=period_tag)
    
    # 4. å‘é‡ç›¸ä¼¼åº¦èšç±»
    embeddings = [get_embedding(item) for item in items]
    clusters = clustering(embeddings, threshold=0.85)
    
    # 5. å‡ºç°æ¬¡æ•°è¿‡æ»¤ï¼ˆå»å™ªï¼‰
    for cluster in clusters:
        if len(cluster) < 2:
            # å•æ¬¡å‡ºç°ï¼Œæ ‡è®°ä¸ºå™ªéŸ³
            for item in cluster:
                item.merge_status = "discarded"
        else:
            # å¤šæ¬¡å‡ºç°ï¼Œè¿›å…¥å…¨å±€å½’å¹¶
            group_id = generate_group_id()
            for item in cluster:
                item.period_merge_group_id = group_id
                item.occurrence_count = len(cluster)
                item.merge_status = "pending_global_merge"
    
    db.commit()
```

**è¾“å‡º**ï¼š
- `source_items` çš„ `merge_status` æ›´æ–°ä¸º `"pending_global_merge"` æˆ– `"discarded"`
- ç›¸ä¼¼æ–°é—»åˆ†é…ç›¸åŒçš„ `period_merge_group_id`
- è¿‡æ»¤æ‰å•æ¬¡å‡ºç°çš„å™ªéŸ³æ•°æ®

---

### 3. å…¨å±€å½’å¹¶æµç¨‹ï¼ˆé˜¶æ®µäºŒï¼‰

**è§¦å‘æ—¶æœº**ï¼šæ¯æ—¥12:30ï¼ˆAMï¼‰, 18:30ï¼ˆPMï¼‰, 22:30ï¼ˆEVEï¼‰

**æ‰§è¡Œæ­¥éª¤**ï¼š

```python
# ä¼ªä»£ç 
def global_merge(period="AM"):
    # 1. æŸ¥è¯¢å¾…å½’å¹¶çš„ç»„
    groups = db.query(SourceItem.period_merge_group_id).filter(
        SourceItem.merge_status == "pending_global_merge",
        SourceItem.period.like(f"%_{period}")
    ).distinct().all()
    
    # 2. æŸ¥è¯¢æ´»è·ƒçš„topics
    active_topics = db.query(Topic).filter(
        Topic.status == "active"
    ).all()
    
    for group_id in groups:
        # 3. è·å–è¯¥ç»„çš„source_items
        group_items = db.query(SourceItem).filter(
            SourceItem.period_merge_group_id == group_id
        ).all()
        
        # 4. è®¡ç®—ä¸ç°æœ‰topicsçš„ç›¸ä¼¼åº¦
        best_match = None
        best_similarity = 0
        
        for topic in active_topics:
            similarity = calculate_similarity(group_items, topic)
            if similarity > best_similarity:
                best_similarity = similarity
                best_match = topic
        
        # 5. åˆ¤æ–­æ˜¯å¦åŒ¹é…
        if best_similarity > 0.8:
            # è¿½åŠ åˆ°ç°æœ‰topic
            topic = best_match
            topic.last_active = now()
            topic.intensity_total += len(group_items)
            
            # åˆ›å»ºæ—¶é—´çº¿èŠ‚ç‚¹
            for item in group_items:
                node = TopicNode(
                    topic_id=topic.id,
                    source_item_id=item.id,
                    appended_at=now()
                )
                db.add(node)
                item.merge_status = "merged"
        else:
            # åˆ›å»ºæ–°topic
            topic = Topic(
                title_key=group_items[0].title,
                first_seen=min(item.fetched_at for item in group_items),
                last_active=max(item.fetched_at for item in group_items),
                status="active",
                intensity_total=len(group_items)
            )
            db.add(topic)
            db.flush()  # è·å–topic.id
            
            # åˆ›å»ºæ—¶é—´çº¿èŠ‚ç‚¹
            for item in group_items:
                node = TopicNode(
                    topic_id=topic.id,
                    source_item_id=item.id,
                    appended_at=now()
                )
                db.add(node)
                item.merge_status = "merged"
        
        # 6. è®°å½•å‘¨æœŸçƒ­åº¦
        heat = TopicPeriodHeat(
            topic_id=topic.id,
            date=today(),
            period=period,
            heat_normalized=calculate_heat(group_items),
            source_count=len(group_items)
        )
        db.add(heat)
    
    db.commit()
```

**è¾“å‡º**ï¼š
- æ–°å¢æˆ–æ›´æ–° `topics` è¡¨è®°å½•
- æ–°å¢ `topic_nodes` è¡¨è®°å½•ï¼ˆå…³è”å…³ç³»ï¼‰
- æ–°å¢ `topic_period_heat` è¡¨è®°å½•ï¼ˆå‘¨æœŸçƒ­åº¦å¿«ç…§ï¼‰
- `source_items` çš„ `merge_status` æ›´æ–°ä¸º `"merged"`

---

### 4. åˆ†ç±»ç»Ÿè®¡æµç¨‹

**è§¦å‘æ—¶æœº**ï¼šæ¯æ—¥å‡Œæ™¨1:00

**æ‰§è¡Œæ­¥éª¤**ï¼š

```python
# ä¼ªä»£ç 
def daily_recompute_metrics():
    categories = ["entertainment", "current_affairs", "sports_esports"]
    today = date.today()
    
    for category in categories:
        # 1. æŸ¥è¯¢è¿‘ä¸€å¹´è¯¥åˆ†ç±»çš„topics
        one_year_ago = today - timedelta(days=365)
        topics = db.query(Topic).filter(
            Topic.category == category,
            Topic.first_seen >= one_year_ago
        ).all()
        
        if not topics:
            continue
        
        # 2. è®¡ç®—å›å£°æ—¶é•¿
        lengths = []
        for topic in topics:
            length_hours = (topic.last_active - topic.first_seen).total_seconds() / 3600
            lengths.append(length_hours)
        
        # 3. è®¡ç®—ç»Ÿè®¡æŒ‡æ ‡
        metrics = CategoryDayMetrics(
            day=today,
            category=category,
            topics_count=len(topics),
            topics_active=sum(1 for t in topics if t.status == "active"),
            topics_ended=sum(1 for t in topics if t.status == "ended"),
            avg_length_hours=mean(lengths),
            max_length_hours=max(lengths),
            min_length_hours=min(lengths),
            intensity_sum=sum(t.intensity_total for t in topics),
            intensity_avg=mean(t.intensity_total for t in topics)
        )
        
        db.add(metrics)
    
    db.commit()
```

**è¾“å‡º**ï¼š
- `category_day_metrics` è¡¨æ–°å¢3æ¡è®°å½•ï¼ˆæ¯ä¸ªåˆ†ç±»1æ¡ï¼‰
- ä¾›é¦–é¡µAPIå¿«é€Ÿè¯»å–

---

### 5. AIæ‘˜è¦ç”Ÿæˆæµç¨‹

**è§¦å‘æ—¶æœº**ï¼š
- æ–°topicåˆ›å»ºåï¼ˆå…¨é‡ç”Ÿæˆï¼‰
- topicæ›´æ–°åï¼ˆå¢é‡ç”Ÿæˆï¼‰

**æ‰§è¡Œæ­¥éª¤**ï¼š

```python
# ä¼ªä»£ç 
def generate_summary(topic_id, method="full"):
    topic = db.query(Topic).get(topic_id)
    
    # 1. è·å–æ—¶é—´çº¿å†…å®¹
    nodes = db.query(TopicNode).filter(
        TopicNode.topic_id == topic_id
    ).order_by(TopicNode.appended_at).all()
    
    source_items = [node.source_item for node in nodes]
    
    # 2. æ„å»ºæç¤ºè¯
    if method == "full":
        # å…¨é‡ç”Ÿæˆï¼šåŸºäºæ‰€æœ‰èŠ‚ç‚¹
        prompt = f"""
        è¯·ä¸ºä»¥ä¸‹äº‹ä»¶ç”Ÿæˆæ‘˜è¦ï¼š
        æ ‡é¢˜ï¼š{topic.title_key}
        ç›¸å…³æ–°é—»ï¼š
        {format_items(source_items)}
        
        è¯·æä¾›ï¼š
        1. äº‹ä»¶æ‘˜è¦ï¼ˆ100å­—å†…ï¼‰
        2. å…³é”®ç‚¹ï¼ˆ3-5æ¡ï¼‰
        3. ç›¸å…³å®ä½“ï¼ˆäººç‰©ã€æœºæ„ã€åœ°ç‚¹ï¼‰
        """
    else:
        # å¢é‡ç”Ÿæˆï¼šåŸºäºæ—§æ‘˜è¦+æ–°èŠ‚ç‚¹
        old_summary = db.query(Summary).get(topic.summary_id)
        new_items = [item for item in source_items if item.fetched_at > old_summary.generated_at]
        
        prompt = f"""
        åŸæ‘˜è¦ï¼š{old_summary.content}
        
        æ–°å¢ä¿¡æ¯ï¼š
        {format_items(new_items)}
        
        è¯·æ›´æ–°æ‘˜è¦ï¼Œæ•´åˆæ–°ä¿¡æ¯ã€‚
        """
    
    # 3. è°ƒç”¨LLM
    response = llm_client.generate(prompt)
    
    # 4. ä¿å­˜æ‘˜è¦
    summary = Summary(
        topic_id=topic_id,
        content=response["summary"],
        method=method,
        generated_at=now(),
        provider="openai",
        model="gpt-4"
    )
    db.add(summary)
    db.flush()
    
    # 5. æ›´æ–°topicçš„summary_id
    topic.summary_id = summary.id
    
    db.commit()
    
    return summary
```

**è¾“å‡º**ï¼š
- `summaries` è¡¨æ–°å¢1æ¡æ‘˜è¦è®°å½•
- `topics` çš„ `summary_id` æ›´æ–°

---

## ç›‘æ§ä¸è¿ç»´

### ç³»ç»Ÿå¥åº·åº¦æ£€æŸ¥

**æ£€æŸ¥é‡‡é›†ä»»åŠ¡çŠ¶æ€**ï¼š
```sql
-- ä»Šå¤©çš„é‡‡é›†è®°å½•
SELECT 
    run_id,
    status,
    started_at,
    success_platforms || '/' || total_platforms AS platforms,
    success_items || '/' || total_items AS items
FROM runs_ingest
WHERE started_at >= CURRENT_DATE
ORDER BY started_at;
```

**æ£€æŸ¥æµæ°´çº¿æ‰§è¡ŒçŠ¶æ€**ï¼š
```sql
-- æœ€è¿‘çš„æµæ°´çº¿ä»»åŠ¡
SELECT 
    stage,
    status,
    started_at,
    success_count || '/' || input_count AS progress,
    duration_ms / 1000.0 AS duration_sec
FROM runs_pipeline
WHERE started_at >= CURRENT_DATE
ORDER BY started_at DESC;
```

**æ£€æŸ¥æ•°æ®å¤„ç†è¿›åº¦**ï¼š
```sql
-- source_itemsçš„å½’å¹¶çŠ¶æ€åˆ†å¸ƒ
SELECT 
    merge_status,
    COUNT(*) AS count
FROM source_items
WHERE fetched_at >= CURRENT_DATE
GROUP BY merge_status;
```

### å¸¸è§é—®é¢˜æ’æŸ¥

**é—®é¢˜1ï¼šé‡‡é›†ä»»åŠ¡å¤±è´¥**
```bash
# æŸ¥çœ‹Workeræ—¥å¿—
tail -100 celery_worker.log | grep scheduled_ingestion

# æŸ¥çœ‹å¤±è´¥åŸå› 
SELECT run_id, error_summary FROM runs_ingest WHERE status = 'failed';
```

**é—®é¢˜2ï¼šå½’å¹¶ä»»åŠ¡å¡ä½**
```sql
-- æ£€æŸ¥å¾…å½’å¹¶çš„æ•°æ®é‡
SELECT 
    halfday_period,
    merge_status,
    COUNT(*) 
FROM source_items 
WHERE merge_status LIKE 'pending%'
GROUP BY halfday_period, merge_status;
```

**é—®é¢˜3ï¼šåˆ†ç±»ç»Ÿè®¡ä¸ºç©º**
```sql
-- æ£€æŸ¥åˆ†ç±»æŒ‡æ ‡è¡¨
SELECT * FROM category_day_metrics ORDER BY day DESC LIMIT 10;

-- æ‰‹åŠ¨è§¦å‘é‡ç®—
-- é€šè¿‡APIè°ƒç”¨ï¼šPOST /api/v1/categories/metrics/recompute
```

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æ•°æ®åº“ç´¢å¼•

å·²åˆ›å»ºçš„å…³é”®ç´¢å¼•ï¼š
- `source_items.idx_platform_fetched_at`ï¼šåŠ é€Ÿå¹³å°æ•°æ®æŸ¥è¯¢
- `source_items.idx_halfday_period_status`ï¼šåŠ é€Ÿå½’å¹¶æŸ¥è¯¢
- `topics.idx_status_last_active`ï¼šåŠ é€Ÿæ´»è·ƒè¯é¢˜æŸ¥è¯¢
- `topic_nodes.idx_topic_appended`ï¼šåŠ é€Ÿæ—¶é—´çº¿æŸ¥è¯¢

### æ•°æ®æ¸…ç†ç­–ç•¥

**å®šæœŸæ¸…ç†æ—§æ•°æ®**ï¼š
```sql
-- æ¸…ç†3ä¸ªæœˆå‰å·²å½’å¹¶çš„source_items
DELETE FROM source_items 
WHERE fetched_at < CURRENT_DATE - INTERVAL '90 days'
  AND merge_status = 'merged';

-- æ¸…ç†6ä¸ªæœˆå‰å·²ç»“æŸçš„topics
DELETE FROM topics 
WHERE status = 'ended' 
  AND last_active < CURRENT_DATE - INTERVAL '180 days';
```

### ç¼“å­˜ç­–ç•¥

**é¦–é¡µåˆ†ç±»ç»Ÿè®¡**ï¼š
- ä½¿ç”¨ `category_day_metrics` é¢„è®¡ç®—è¡¨
- æ¯æ—¥1:00è‡ªåŠ¨æ›´æ–°
- APIä¼˜å…ˆè¯»å–ç¼“å­˜ï¼Œé™ä½å®æ—¶è®¡ç®—å‹åŠ›

**çƒ­é—¨è¯é¢˜åˆ—è¡¨**ï¼š
- æŒ‰ `current_heat_normalized` æ’åº
- ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
- è€ƒè™‘ä½¿ç”¨Redisç¼“å­˜Top 50

---

## é™„å½•

### æ—¶é—´è®¾ç½®è¯´æ˜

**ç³»ç»Ÿæ—¶åŒº**ï¼šUTC  
**ç”¨æˆ·æ—¶åŒº**ï¼šAsia/Shanghaiï¼ˆUTC+8ï¼‰  
**Celeryæ—¶åŒºé…ç½®**ï¼š`timezone="Asia/Shanghai"`

**å®šæ—¶ä»»åŠ¡æ—¶é—´è¡¨**ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰ï¼š

| ä»»åŠ¡ | æ—¶é—´ | è¯´æ˜ |
|------|------|------|
| æ•°æ®é‡‡é›† | 08:00, 10:00, 12:00, 14:00, 16:00, 18:00, 20:00, 22:00 | æ¯2å°æ—¶ |
| ä¸ŠåŠæ—¥å½’å¹¶ | 12:15 | å½’å¹¶00:00-12:00çš„æ•°æ® |
| ä¸ŠåŠæ—¥å…¨å±€å½’å¹¶ | 12:30 | ä¸å†å²topicæ¯”å¯¹ |
| ä¸‹åŠæ—¥å½’å¹¶ | 22:15 | å½’å¹¶12:00-24:00çš„æ•°æ® |
| ä¸‹åŠæ—¥å…¨å±€å½’å¹¶ | 22:30 | ä¸å†å²topicæ¯”å¯¹ |
| åˆ†ç±»æŒ‡æ ‡é‡ç®— | 01:00 | æ¯æ—¥é‡ç®— |

### æ•°æ®æºè¯´æ˜

| å¹³å° | é‡‡é›†å†…å®¹ | æ¯æ¬¡é‡‡é›†æ•° |
|------|---------|-----------|
| å¾®åš | çƒ­æœæ¦œ | 30æ¡ |
| çŸ¥ä¹ | çƒ­æ¦œ | 30æ¡ |
| ä»Šæ—¥å¤´æ¡ | çƒ­æ¦œ | 30æ¡ |
| æ–°æµªæ–°é—» | æ’è¡Œæ¦œ | 10æ¡ |
| ç½‘æ˜“æ–°é—» | æ’è¡Œæ¦œ | 10æ¡ |
| ç™¾åº¦ | çƒ­æœæ¦œ | 30æ¡ |
| è™æ‰‘ | çƒ­å¸–æ¦œ | 20æ¡ |

**æ€»è®¡**ï¼šæ¯æ¬¡é‡‡é›†çº¦160æ¡æ•°æ®ï¼ˆå»é‡åå®é™…å…¥åº“å¯èƒ½æ›´å°‘ï¼‰

---

## æ›´æ–°æ—¥å¿—

**v1.0 (2025-11-04)**
- åˆå§‹ç‰ˆæœ¬
- å®Œæ•´çš„æ•°æ®æµè½¬æ¶æ„è¯´æ˜
- åŒ…å«æ‰€æœ‰æ ¸å¿ƒè¡¨ç»“æ„å’Œæµç¨‹

---

**æ–‡æ¡£ç»´æŠ¤**ï¼šæœ¬æ–‡æ¡£åº”éšç³»ç»Ÿæ¶æ„å˜åŒ–åŠæ—¶æ›´æ–°

