Echoman backend experiment environment (text version)

Runtime
- Language: Python 3.11

Core Libraries (name==version)
- fastapi==0.115.0
- uvicorn[standard]==0.30.6
- httpx==0.27.2
- pydantic==2.8.2
- pydantic-settings==2.4.0
- SQLAlchemy==2.0.34
- asyncpg==0.29.0
- alembic==1.13.2
- pgvector==0.3.3
- redis==5.0.8
- celery==5.4.0
- tenacity==9.0.0
- orjson==3.10.7
- python-dotenv==1.0.1
- prometheus-client==0.21.0
- sse-starlette==2.2.1

Crawl & Parsing
- beautifulsoup4==4.12.3
- lxml==5.3.0
- selectolax==0.3.21
- trafilatura==1.12.2
- tldextract==5.1.2

Dedup & Clustering
- rapidfuzz==3.10.0
- jieba==0.42.1
- simhash==2.1.2
- numpy==2.1.1
- scikit-learn==1.5.2

Embedding & LLM
- sentence-transformers==3.1.1
- openai==1.52.2
- dashscope==1.20.14
- langchain==0.3.2
- langchain-core==0.3.8
- langchain-community==0.3.1
- langchain-openai==0.2.2
- langgraph==0.2.22
- tiktoken==0.7.0

Observability (optional)
- opentelemetry-sdk==1.27.0
- langsmith==0.1.114

Services
- PostgreSQL 15 (metadata)
- Redis 6
- Chroma (向量存储，持久化目录 ./data/chroma)

Providers (LLM/Embedding)
- Cloud: OpenAI / Azure OpenAI / Qwen (DashScope)
- Local: sentence-transformers (e.g., bge-m3)

Notes
- 向量检索：纯 Chroma，召回 Top-K=3，候选时间窗 180 天；新建/合并时写占位摘要向量。
- 新建 Topic 热度截断：`GLOBAL_MERGE_NEW_TOPIC_KEEP_RATIO`（当前 0.5，默认 1.0）；截断不二次归一化，被截断的 Topic 直接 ended。
- Schedule ingestion: 8:00-22:00, every 2 hours (8 times/day).
- Schedule merge: 3 times/day, 12:05+12:20 (AM), 18:05+18:20 (PM), 22:05+22:20 (EVE).
- Period format: Halfday (e.g., 2025-12-30_PM).
- Data latency: ~15-30 minutes between last collection and merge.
- Enforce timeouts, retries, rate limits for crawl and LLM.
- LLM response parsing: Handle Qwen think-tags (<think>), extract JSON with fallback.
- Asyncio safety: Database engine lazy init to prevent event loop conflicts in Celery.
- RAG system: Dual-mode (global/topic), SSE streaming, context management client-side.
- Global merge: 串行分组处理，批量摘要生成。

Platform Implementation Status (Updated: 2025-11-06)
✅ Implemented (7 platforms):
  - weibo: Weibo hot search (30 items)
  - zhihu: Zhihu hot topics (30 items)
  - toutiao: Toutiao hot news (30 items)
  - sina: Sina news (10 items)
  - netease: NetEase news hot rank (10 items)
  - baidu: Baidu hot search (30 items)
  - hupu: Hupu sports (basketball + football, 20 items)

❌ Removed (3 platforms):
  - tencent: API unstable, high maintenance cost
  - xhs: Complex anti-crawl, requires signature algorithm
  - douyin: Complex cookie management (msToken, ttwid)

Success Rate: 100% (7/7)
